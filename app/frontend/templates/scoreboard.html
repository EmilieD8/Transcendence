{% extends "index.html" %}
{% load i18n %}
{% block content %}
    <div class="container mt-4">
      <h1 class="text-center">{{ request.user.username }}'s stats</h1>
      <div class="row">
        <div class="col-md-6 offset-md-3">
          <ul class="list-group" id="game-list">
            <p style="padding-top: 1em">{% trans 'Pong:'  %}</p>
            <li class="list-group-item">{% trans "Games Played:" %} {{ games_played_pong}}</li>
            <li class="list-group-item">{% trans "Games Won:" %} {{ games_won_pong }}</li>
            <li class="list-group-item">{% trans "Win Streak:" %} {{ pong_max_win_streak }}</li>
            <p style="padding-top: 1em">{% trans "Memory:" %}</p>
            <li class="list-group-item">{% trans "Games Played:" %} {{games_played_memory}}</li>
            <li class="list-group-item">{% trans "Games Won:" %} {{games_won_memory}}</li>
            <li class="list-group-item">{% trans "Win Streak:" %} {{memory_max_win_streak}}</li>
            <p style="padding-top: 1em">{% trans 'Historic:'  %}</p>
            {% for game in all_games %}
              <li class="list-group-item game-item" style="display: none;">
                {{ game.game_date }} - Game:
                {% if game.pong_game %}
                {% trans 'Pong'  %}
                {% elif game.memory_game %}
                {% trans 'Memory'  %}
                {% endif %}
                - {% trans 'Type'  %}:
                {% if game.is_tournament %}
                {% trans 'Tournament'  %}
                {% else %}
                {% trans '1vs1'  %}
                {% endif %}
                - {% trans 'Players'  %}:
                {% for participant in game.participants.all %}
                  {{ participant.display_name }}{% if not forloop.last %} vs {% endif %}
                {% endfor %}
                - {% trans 'Winner'  %}: {{ game.winner.display_name }} - {% trans 'Score'  %}: {{ game.score_winner }} - {{ game.score_loser }}
              </li>
            {% endfor %}
          </ul>
          <div class="pagination-buttons">
            <button id="prev-page" class="btn btn-primary" style="margin-top: 10px;">{% trans 'Previous'  %}</button>
            <button id="next-page" class="btn btn-primary" style="margin-top: 10px;">{% trans 'Next'  %}</button>
          </div>
        </div>
      </div>
    </div>
    


    <script>
      document.addEventListener("DOMContentLoaded", function() {
        console.log("DOM fully loaded and parsed");
        const gameItems = document.querySelectorAll('.game-item');
        let currentPage = 0;
        const itemsPerPage = 5;

        function showPage(page) {
          for (let i = 0; i < gameItems.length; i++) {
            if (i >= page * itemsPerPage && i < (page + 1) * itemsPerPage) {
              gameItems[i].style.display = 'block';
            } else {
              gameItems[i].style.display = 'none';
            }
          }
        }

        document.getElementById('next-page').addEventListener('click', function() {
          if ((currentPage + 1) * itemsPerPage < gameItems.length) {
            currentPage++;
            showPage(currentPage);
          }
        });

        document.getElementById('prev-page').addEventListener('click', function() {
          if (currentPage > 0) {
            currentPage--;
            showPage(currentPage);
          }
        });

        showPage(currentPage);
      });
    </script>
{% endblock %}